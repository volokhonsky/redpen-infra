# Структура проекта RedPen

Этот документ объясняет структуру проекта RedPen, который разделен на три отдельных репозитория.

## Обзор

Проект RedPen состоит из трех репозиториев:

1. **Репозиторий Frontend** - Содержит статический веб-сайт, который отображает аннотированные страницы учебника
2. **Репозиторий обработки PDF** - Содержит Python-скрипты для обработки PDF-файлов и генерации данных
3. **Репозиторий артефактов** - Хранит сгенерированные данные (изображения и JSON-файлы)

## Детали репозиториев

### 1. Репозиторий Frontend

**Назначение**: Служит статическим веб-сайтом, который отображает аннотированные страницы учебника.

**Ключевые компоненты**:
- `templates/` - Содержит шаблоны для статического веб-сайта
  - `index.html` - Основной HTML-файл
  - `css/` - Таблицы стилей для веб-сайта
  - `js/` - JavaScript-файлы для функциональности
  - `favicon.svg` - Иконка для веб-сайта
- Ссылается на данные из репозитория артефактов

### 2. Репозиторий обработки PDF

**Назначение**: Обрабатывает PDF-файлы для извлечения изображений, текста и генерации шаблонов аннотаций.

**Ключевые компоненты**:
- `process_pdf.py` - Основной скрипт, который организует весь рабочий процесс
- `extract_images.py` - Извлекает изображения из PDF-файлов
- `extract_text.py` - Извлекает текст из PDF-файлов и конвертирует в JSON
- `generate_annotations.py` - Генерирует шаблоны аннотаций
- `publish_data.py` - Публикует данные в репозиторий артефактов

### 3. Репозиторий артефактов

**Назначение**: Хранит сгенерированные данные и содержит полностью функциональный веб-сайт, который может быть развернут напрямую.

**Ключевые компоненты**:
- `images/` - Содержит PNG-изображения страниц учебника
- `text/` - Содержит JSON-файлы с текстовыми данными
- `annotations/` - Содержит JSON-файлы с данными аннотаций
- `templates/` - Содержит шаблоны для статического веб-сайта
  - `css/` - Таблицы стилей для веб-сайта
  - `js/` - JavaScript-файлы для функциональности
  - `favicon.svg` - Иконка для веб-сайта
- `index.html` - Основной HTML-файл для статического веб-сайта

## Рабочий процесс

1. **Обработка PDF**:
   - PDF-файл обрабатывается с использованием скриптов в репозитории обработки PDF
   - Изображения извлекаются из PDF
   - Текст извлекается и конвертируется в структурированный JSON
   - Генерируются шаблоны аннотаций

2. **Публикация данных**:
   - Сгенерированные данные (изображения, текст, аннотации) публикуются в репозиторий артефактов

3. **Отображение Frontend**:
   - Репозиторий Frontend использует данные из репозитория артефактов для отображения контента
   - Пользователи могут просматривать страницы учебника с аннотациями в веб-браузере

## Настройка разработки

Для настройки проекта для разработки:

1. Клонировать все три репозитория
2. Установить зависимости для репозитория обработки PDF:
   ```bash
   cd redpen-infra
   pip install -r scripts/requirements.txt
   ```
3. Обработать PDF-файл:
   ```bash
   python scripts/process_pdf.py path/to/textbook.pdf --artifacts-repo ../redpen-publish
   ```
4. Открыть templates/index.html репозитория Frontend в веб-браузере для просмотра результатов или использовать полностью функциональный веб-сайт в репозитории артефактов, открыв его index.html

## Развертывание

Для развертывания:

1. Обработать PDF-файлы с использованием репозитория обработки PDF
2. Развернуть репозиторий артефактов в веб-доступном месте
3. Развернуть репозиторий Frontend как статический веб-сайт
4. Настроить репозиторий Frontend для доступа к репозиторию артефактов в месте его развертывания